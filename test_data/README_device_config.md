# 设备桶数配置文件说明

## 📍 配置文件位置

**文件路径**: `test_data/device_config.csv`

**完整路径**: 项目根目录下的 `test_data` 文件夹中

## 📝 文件格式

配置文件为CSV格式，必须包含以下列：

```csv
device_code,barrel_count
MO24032700700011,2
MO24032700700020,3
```

### 列说明

- **device_code**: 设备编码（必填）
  - 格式要求：以字母开头，只能包含字母和数字
  - 示例：`MO24032700700011`、`TW24011700700044`
  
- **barrel_count**: 油桶数量（必填）
  - 格式要求：整数，必须 >= 1
  - 示例：`2`、`3`、`4`

## 🔧 如何维护配置文件

### 方法1: 使用Excel编辑（推荐）

1. 用Excel打开 `test_data/device_config.csv` 文件
2. 添加、修改或删除设备配置
3. 保存文件（建议保存为CSV格式）

### 方法2: 使用文本编辑器

1. 用记事本或其他文本编辑器打开 `test_data/device_config.csv` 文件
2. 按照CSV格式添加、修改或删除设备配置
3. 保存文件

## ⚠️ 注意事项

1. **文件编码**: 支持 UTF-8、UTF-8-SIG、GBK、GB2312 编码
2. **表头必须保留**: 第一行 `device_code,barrel_count` 不能删除
3. **设备编码不能为空**: 空设备编码的行会被自动跳过
4. **桶数必须为正整数**: 
   - 如果桶数为空，将使用默认值1
   - 如果桶数格式错误（非数字），将使用默认值1
   - 如果桶数小于1，将使用默认值1
5. **重复设备编码**: 如果同一设备编码出现多次，后面的配置会覆盖前面的

## 📊 维护记录

配置文件最近一次维护时间会在以下位置显示：

1. **控制台输出**: 生成报表时会在控制台显示配置信息
2. **Excel报表**: 在"非单桶设备编码"Sheet中显示配置信息

## 🔍 如何查看配置文件信息

### 在报表生成时查看

生成误差汇总报表时，控制台会自动显示：

```
============================================================
设备桶数配置信息
============================================================
配置文件位置: D:\Daily_Report\test_data\device_config.csv
配置设备数量: 28
最近维护时间: 2025-01-15 14:30:25
维护类型: 修改
============================================================
```

### 在Excel报表中查看

打开生成的Excel报表，切换到"非单桶设备编码"Sheet，顶部会显示：

```
配置文件位置: D:\Daily_Report\test_data\device_config.csv
最近维护时间: 2025-01-15 14:30:25 (修改)
```

## 📋 维护事件类型

以下操作都算作一次维护事件：

- **增加**: 添加新的设备编码和桶数配置
- **修改**: 修改已有设备的桶数
- **删除**: 删除设备配置

## 💡 使用建议

1. **定期维护**: 当设备数据变动时，及时更新配置文件
2. **备份配置**: 修改前建议备份配置文件
3. **验证格式**: 修改后可以生成报表验证配置是否正确
4. **记录变更**: 建议在修改时记录变更原因，方便追溯

## ❓ 常见问题

### Q: 配置文件在哪里？

A: 在项目根目录的 `test_data` 文件夹中，文件名为 `device_config.csv`

### Q: 如何找到项目根目录？

A: 项目根目录通常包含以下文件/文件夹：
- `src/` 文件夹
- `test_data/` 文件夹
- `config/` 文件夹
- `README.md` 文件

### Q: 配置文件不存在怎么办？

A: 如果配置文件不存在，所有设备将使用默认桶数1。您可以创建该文件并添加设备配置。

### Q: 如何更新维护时间？

A: 维护时间会在以下情况自动更新：
- 检测到配置文件被修改（通过文件修改时间）
- 手动调用维护时间更新工具（如果提供）

### Q: 配置文件格式错误怎么办？

A: 如果配置文件格式错误，系统会显示警告信息，并使用默认桶数1。请检查：
1. 文件编码是否正确
2. 表头是否存在
3. 列名是否正确
4. 数据格式是否符合要求

## 📞 需要帮助？

如果遇到问题，请检查：
1. 控制台输出的错误信息
2. Excel报表中的配置信息
3. 本说明文档

