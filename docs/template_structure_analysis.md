# 客户对账单Excel模板结构分析

## 模板文件
- 文件路径: `template/statement_template.xlsx`
- 工作表数量: 3个
- 工作表名称: `中润对账单`, `每日用量明细`, `每月用量对比`

---

## Sheet 1: 中润对账单

### 基本信息
- 最大行数: 24
- 最大列数: 9

### 布局结构

#### 行5: 客户信息和月份
- **A5**: `客户名称：浙江巨跃齿轮有限公司`
  - 字体: 黑体, 11pt
  - 对齐: 垂直居中
- **G5**: `月份：7月份（2025.7.1-2025.7.31）`
  - 字体: 黑体, 11pt
  - 对齐: 水平右对齐, 垂直居中

#### 行8: 表头
- **A8**: `序号`
  - 字体: 黑体, 11pt
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: RGB `#005C37` (深绿色)
  - 边框: 四周边框 (thin)
- **B8**: `油品名称/型号`
  - 字体: 黑体, 11pt
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: RGB `#005C37` (深绿色)
  - 边框: 四周边框 (thin)
- **E8**: `设备编码`
  - 字体: 黑体, 11pt
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: RGB `#005C37` (深绿色)
  - 边框: 四周边框 (thin)
- **F8**: `本月总升数计量（L）`
  - 字体: 黑体, 11pt
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: RGB `#005C37` (深绿色)
  - 边框: 四周边框 (thin)
- **H8**: `备注`
  - 字体: 黑体, 11pt
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: RGB `#005C37` (深绿色)
  - 边框: 四周边框 (thin)

#### 行9开始: 数据行
- **A列**: 序号 (整数)
  - 字体: 黑体, 10pt
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: Theme 9, Tint 0.8 (浅绿色背景)
  - 边框: 四周边框 (thin)
- **B列**: 油品名称/型号 (字符串)
  - 字体: 黑体, 10pt
  - 对齐: 水平居中, 垂直居中
  - 填充: Theme 9, Tint 0.8 (浅绿色背景)
  - 边框: 四周边框 (thin)
- **E列**: 设备编码 (字符串)
  - 字体: 黑体, 10pt
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: Theme 9, Tint 0.8 (浅绿色背景)
  - 边框: 四周边框 (thin)
- **F列**: 本月总升数计量（L）(浮点数)
  - 字体: 黑体, 10pt
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: Theme 9, Tint 0.8 (浅绿色背景)
  - 边框: 四周边框 (thin)
  - 数字格式: `0.00_ ` (保留2位小数)
- **H列**: 备注 (字符串，可选)
  - 字体: 黑体, 10pt
  - 对齐: 水平居中, 垂直居中
  - 边框: 四周边框 (thin)

#### 特殊行
- **行13 (B13)**: `以下空白` (当数据行少于20行时显示)
  - 字体: 黑体, 10pt
  - 对齐: 水平居中, 垂直居中
  - 填充: Theme 9, Tint 0.8 (浅绿色背景)
  - 边框: 四周边框 (thin)

#### 行18: 图表标题
- **A18**: `月度使用量趋势分析`
  - 字体: 黑体, 11pt
  - 对齐: 水平居中, 垂直居中
  - 填充: RGB `#164D1C` (深绿色)
  - 边框: 左右边框 (thin)

---

## Sheet 2: 每日用量明细

### 基本信息
- 最大行数: 38
- 最大列数: 8
- 合并单元格: 2个
  - A37:B37
  - A6:A36 (年月列合并)

### 列宽
- A: 11.125
- B: 15.625
- C: 24.408
- E: 24.408
- F: 24.408
- G: 19.258
- H: 17.5

### 行高
- 行1: 36.0
- 行2: 40.0
- 行3: 40.0
- 行4: 21.0
- 行5: 50.0

### 布局结构

#### 行2-3: 日期范围
- **G2**: `初始日期`
  - 字体: 微软雅黑, 10pt
  - 对齐: 水平居中, 垂直居中
  - 填充: RGB `#BDD7A1` (浅绿色)
  - 边框: 左、上、下边框 (thin)
- **H2**: `结束日期`
  - 字体: 微软雅黑, 10pt
  - 对齐: 水平居中, 垂直居中
  - 填充: RGB `#BDD7A1` (浅绿色)
  - 边框: 上、下边框 (thin)
- **G3**: 初始日期值 (datetime对象)
  - 字体: 微软雅黑, 10pt
  - 对齐: 水平居中, 垂直居中
  - 边框: 左、上、下边框 (thin)
  - 数字格式: `yyyy"年"m"月"d"日";@`
- **H3**: 结束日期值 (datetime对象)
  - 字体: 微软雅黑, 10pt
  - 对齐: 水平居中, 垂直居中
  - 边框: 上、下边框 (thin)
  - 数字格式: `yyyy"年"m"月"d"日";@`

#### 行5: 表头
- **A5**: `用油型号` (多行文本，带空格)
  - 字体: 微软雅黑, 11pt, 粗体
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: RGB `#CADFB3` (浅绿色)
  - 边框: 左、上边框 (thin)
- **B5**: `日`
  - 字体: 微软雅黑, 11pt, 粗体
  - 对齐: 垂直居中, 自动换行
  - 填充: RGB `#CADFB3` (浅绿色)
  - 边框: 左、上边框 (thin)
- **C5开始**: 各设备-油品组合的列标题 (动态生成)
  - 格式: `{device_code}-{oil_name}`

#### 行6开始: 数据行
- **A列**: 年月 (格式: `YYYY年\nM月`)
  - 字体: 微软雅黑, 10pt
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 边框: 四周边框 (thin)
  - 合并单元格: 按月份合并多行
- **B列**: 日期 (日)
  - 字体: 微软雅黑, 10pt
  - 对齐: 水平居中, 垂直居中
  - 边框: 四周边框 (thin)
- **C列开始**: 各设备-油品组合的每日用量 (浮点数)
  - 字体: 微软雅黑, 10pt
  - 对齐: 水平居中, 垂直居中
  - 边框: 四周边框 (thin)
  - 数字格式: `0.00` (保留2位小数)

---

## Sheet 3: 每月用量对比

### 基本信息
- 最大行数: 41
- 最大列数: 15
- 合并单元格: 3个
  - A1:O1 (截止日期行)
  - O5:O6 (合计列标题)
  - C5:N5 (年份标题)

### 列宽
- A: 19.75
- B: 19.0
- C: 9.875
- O: 9.0

### 行高
- 行1: 36.0
- 行2: 40.0
- 行3: 40.0
- 行4: 21.0
- 行5: 23.0
- 行6: 36.0
- 行7-12: 34.0

### 布局结构

#### 行1: 截止日期
- **A1**: `截止日期：2025年7月31日` (合并A1:O1)
  - 字体: 微软雅黑, 11pt
  - 对齐: 水平右对齐, 垂直居中
  - 数字格式: `#,##0_ ;[Red]\-#,##0\ `

#### 行5: 年份和合计标题
- **A5**: 空 (多行空格)
  - 字体: 微软雅黑, 11pt, 粗体, 白色
  - 对齐: 垂直居中, 自动换行
  - 填充: Theme 9
  - 边框: 四周边框 (thin)
- **C5**: `2024年` (合并C5:N5)
  - 字体: 微软雅黑, 11pt, 粗体, 白色
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: Theme 9
  - 边框: 四周边框 (thin)
- **O5**: `合计` (合并O5:O6)
  - 字体: 微软雅黑, 11pt, 粗体, 白色
  - 对齐: 水平居中, 垂直居中
  - 填充: Theme 9
  - 边框: 四周边框 (thin)
  - 数字格式: `General"月"`

#### 行6: 表头
- **A6**: `设备编号`
  - 字体: 微软雅黑, 11pt, 粗体, 白色
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: Theme 9
  - 边框: 四周边框 (thin)
- **B6**: `油品名称`
  - 字体: 微软雅黑, 11pt, 粗体, 白色
  - 对齐: 垂直居中, 自动换行
  - 填充: Theme 9
  - 边框: 四周边框 (thin)
- **C6-N6**: `1月`, `2月`, ..., `12月`
  - 字体: 微软雅黑, 11pt, 粗体, 白色
  - 对齐: 水平居中, 垂直居中, 自动换行
  - 填充: Theme 9
  - 边框: 四周边框 (thin)
- **C6开始**: 各设备-油品组合的列标题 (动态生成)
  - 格式: `{device_code}-{oil_name}`

#### 行7开始: 数据行 (每行对应一个月份)
- **A列**: 设备编号 (空，因为按月份组织)
- **B列**: 月份标签 (`1月`, `2月`, ..., `12月`)
  - 字体: 微软雅黑, 11pt
  - 对齐: 水平居中, 垂直居中
  - 边框: 四周边框 (thin)
- **C列开始**: 各设备-油品组合的月份用量 (浮点数)
  - 字体: 微软雅黑, 11pt
  - 对齐: 水平居中, 垂直居中
  - 填充: RGB `#FFFFFF` (白色)
  - 边框: 四周边框 (thin)
  - 数字格式: `0.00_ ` (保留2位小数)
- **O列**: 合计 (SUM公式)
  - 公式: `=SUM(C{row}:N{row})`
  - 字体: 微软雅黑, 11pt, 黑色
  - 对齐: 水平居中, 垂直居中
  - 填充: RGB `#FFFFFF` (白色)
  - 边框: 四周边框 (thin)
  - 数字格式: `0.00_ ` (保留2位小数)

---

## 样式总结

### 字体
- **中润对账单**: 主要使用 `黑体`
  - 表头: 11pt
  - 数据: 10pt
- **每日用量明细**: 主要使用 `微软雅黑`
  - 表头: 11pt, 粗体
  - 数据: 10pt
- **每月用量对比**: 主要使用 `微软雅黑`
  - 表头: 11pt, 粗体, 白色
  - 数据: 11pt

### 颜色方案
- **深绿色**: RGB `#005C37` (中润对账单表头)
- **浅绿色**: RGB `#BDD7A1` (每日用量明细日期标题)
- **浅绿色**: RGB `#CADFB3` (每日用量明细表头)
- **深绿色**: RGB `#164D1C` (图表标题)
- **Theme 9, Tint 0.8**: (中润对账单数据行背景)
- **Theme 9**: (每月用量对比表头背景)
- **白色**: RGB `#FFFFFF` (每月用量对比数据行背景)

### 对齐方式
- **表头**: 水平居中, 垂直居中, 自动换行
- **数据**: 水平居中, 垂直居中
- **客户名称**: 垂直居中
- **月份**: 水平右对齐, 垂直居中
- **截止日期**: 水平右对齐, 垂直居中

### 边框
- **标准边框**: 四周边框 (thin)
- **部分单元格**: 左、上、下边框 (thin)

### 数字格式
- **日期**: `yyyy"年"m"月"d"日";@`
- **浮点数**: `0.00_ ` (保留2位小数)
- **合计**: `0.00_ ` (保留2位小数)

### 合并单元格
- **中润对账单**: 无
- **每日用量明细**: 
  - A6:A36 (年月列按月份合并)
  - A37:B37 (可能用于总计)
- **每月用量对比**:
  - A1:O1 (截止日期行)
  - C5:N5 (年份标题)
  - O5:O6 (合计列标题)

---

## 数据填充规则

### 中润对账单
1. 行5: 更新客户名称和月份
2. 行8: 表头（固定）
3. 行9开始: 数据行
   - A列: 序号 (1, 2, 3...)
   - B列: 油品名称/型号
   - E列: 设备编码
   - F列: 本月总升数计量（L）
   - H列: 备注（可选）
4. 如果数据行少于20行，在B列显示"以下空白"

### 每日用量明细
1. 行2-3: 更新初始日期和结束日期
2. 行5: 表头（用油型号、日，以及各设备-油品组合的列标题）
3. 行6开始: 数据行
   - A列: 年月（按月份合并）
   - B列: 日期（日）
   - C列开始: 各设备-油品组合的每日用量

### 每月用量对比
1. 行1: 更新截止日期
2. 行5: 年份和合计标题（固定）
3. 行6: 表头（设备编号、油品名称、1-12月，以及各设备-油品组合的列标题）
4. 行7开始: 数据行（每行对应一个月份）
   - A列: 设备编号（空）
   - B列: 月份标签（1月-12月）
   - C列开始: 各设备-油品组合的月份用量
   - O列: 合计（SUM公式）

---

## 注意事项

1. **日期格式**: 使用datetime对象和number_format，而不是字符串
2. **合并单元格**: 需要正确处理合并单元格，避免覆盖
3. **列标题**: 每日用量明细和每月用量对比的列标题是动态生成的（设备编码-油品名称）
4. **样式保持**: 填充数据时，需要保持原有的字体、对齐、填充、边框等样式
5. **数字格式**: 浮点数需要设置正确的数字格式（保留2位小数）

